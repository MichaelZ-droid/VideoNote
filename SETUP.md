# VideoNote è®¾ç½®æŒ‡å—

## ğŸš€ å¿«é€Ÿå¼€å§‹

VideoNote å·²ç»å®ŒæˆåŸºç¡€è®¾ç½®ï¼ç°åœ¨æ‚¨éœ€è¦é…ç½®é˜¿é‡Œäº‘ç™¾ç‚¼çš„ API å‡­è¯ã€‚

### ğŸ“ å‰ç½®æ¡ä»¶

1. âœ… Supabase é¡¹ç›®å·²è¿æ¥
2. âœ… å­˜å‚¨æ¡¶å·²åˆ›å»ºï¼ˆtemp-audioï¼‰
3. âœ… Edge Function å·²éƒ¨ç½²ï¼ˆprocess-video-summaryï¼‰
4. âš ï¸ **éœ€è¦é…ç½®é˜¿é‡Œäº‘ API å‡­è¯**

### ğŸ”‘ é…ç½®é˜¿é‡Œäº‘å‡­è¯

æ‚¨å·²ç»é€šè¿‡å®‰å…¨ç•Œé¢æ·»åŠ äº†ä»¥ä¸‹å¯†é’¥ï¼š
- `ALIYUN_ACCESS_KEY_ID`
- `ALIYUN_ACCESS_KEY_SECRET`

### ğŸ› ï¸ æ›´æ–° Edge Function

**é‡è¦**ï¼šç›®å‰ Edge Function ä½¿ç”¨çš„æ˜¯æ¨¡æ‹Ÿæ•°æ®ã€‚æ‚¨éœ€è¦æ ¹æ®é˜¿é‡Œäº‘ç™¾ç‚¼çš„å®é™… API æ–‡æ¡£æ›´æ–°ä»¥ä¸‹æ–‡ä»¶ï¼š

`supabase/functions/process-video-summary/index.ts`

éœ€è¦é›†æˆï¼š
1. **Paraformer API**ï¼ˆè¯­éŸ³è¯†åˆ«ï¼‰
   - è¾“å…¥ï¼šéŸ³é¢‘æ–‡ä»¶ URL
   - è¾“å‡ºï¼šå¸¦æ—¶é—´æˆ³çš„æ–‡å­—ç¨¿

2. **Qwen3-max API**ï¼ˆæ–‡æœ¬æ‘˜è¦ï¼‰
   - è¾“å…¥ï¼šæ–‡å­—ç¨¿
   - è¾“å‡ºï¼šç»“æ„åŒ–æ‘˜è¦

### ğŸ“š é˜¿é‡Œäº‘ç™¾ç‚¼ API æ–‡æ¡£

è¯·å‚è€ƒé˜¿é‡Œäº‘ç™¾ç‚¼å®˜æ–¹æ–‡æ¡£ï¼š
- æ§åˆ¶å°ï¼šhttps://bailian.console.aliyun.com/
- API æ–‡æ¡£ï¼šæ ¹æ®æ‚¨çš„æœåŠ¡ç±»å‹æŸ¥çœ‹å¯¹åº”æ–‡æ¡£

å…¸å‹çš„ API è°ƒç”¨æµç¨‹ï¼š
```typescript
// 1. è°ƒç”¨ Paraformer è¿›è¡Œè¯­éŸ³è¯†åˆ«
const transcriptResponse = await fetch(PARAFORMER_API_URL, {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${aliyunAccessKeyId}:${aliyunAccessKeySecret}`,
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    audio_url: audioUrl,
    // å…¶ä»–å¿…éœ€å‚æ•°...
  }),
});

// 2. ä½¿ç”¨ Qwen3-max ç”Ÿæˆæ‘˜è¦
const summaryResponse = await fetch(QWEN_API_URL, {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${aliyunAccessKeyId}:${aliyunAccessKeySecret}`,
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    messages: [{
      role: 'user',
      content: `è¯·åŸºäºä»¥ä¸‹æ–‡å­—ç¨¿ç”Ÿæˆç»“æ„åŒ–æ‘˜è¦...\n${transcript}`
    }],
    // å…¶ä»–å¿…éœ€å‚æ•°...
  }),
});
```

### ğŸ¯ åŠŸèƒ½ç‰¹æ€§

âœ… **å·²å®ç°**ï¼š
- æ‹–æ‹½ä¸Šä¼ è§†é¢‘ï¼ˆæœ€å¤§ 1GBï¼‰
- æµè§ˆå™¨ç«¯éŸ³é¢‘æå–ï¼ˆffmpeg.wasmï¼‰
- éŸ³é¢‘æ–‡ä»¶ä¸Šä¼ åˆ° Supabase Storage
- å®æ—¶è¿›åº¦æ˜¾ç¤º
- å“åº”å¼å¸ƒå±€ï¼ˆæ¡Œé¢ + ç§»åŠ¨ç«¯ï¼‰
- æ·±è‰²/æµ…è‰²ä¸»é¢˜åˆ‡æ¢
- æ—¶é—´æˆ³è·³è½¬åŠŸèƒ½
- å¤åˆ¶å’Œå¯¼å‡º Markdown

â³ **å¾…å®Œæˆ**ï¼š
- é›†æˆçœŸå®çš„é˜¿é‡Œäº‘ Paraformer API
- é›†æˆçœŸå®çš„é˜¿é‡Œäº‘ Qwen3-max API
- æ ¹æ®å®é™… API å“åº”æ ¼å¼è°ƒæ•´æ•°æ®å¤„ç†é€»è¾‘

### ğŸ§ª æµ‹è¯•æ­¥éª¤

1. è¿è¡Œå¼€å‘æœåŠ¡å™¨ï¼š`pnpm dev`
2. æ‰“å¼€æµè§ˆå™¨ï¼šhttp://localhost:8080
3. ä¸Šä¼ ä¸€ä¸ªæµ‹è¯•è§†é¢‘ï¼ˆå»ºè®® < 100MB ç”¨äºå¿«é€Ÿæµ‹è¯•ï¼‰
4. è§‚å¯ŸéŸ³é¢‘æå–è¿›åº¦
5. æŸ¥çœ‹ç”Ÿæˆçš„æ¨¡æ‹Ÿæ‘˜è¦ï¼ˆå®é™…ä½¿ç”¨éœ€è¦é…ç½®çœŸå® APIï¼‰

### âš ï¸ é‡è¦æç¤º

1. **SharedArrayBuffer æ”¯æŒ**
   - ffmpeg.wasm éœ€è¦æµè§ˆå™¨æ”¯æŒ SharedArrayBuffer
   - Vite å·²é…ç½®å¿…éœ€çš„å“åº”å¤´
   - ç¡®ä¿åœ¨æ”¯æŒçš„æµè§ˆå™¨ä¸­æµ‹è¯•ï¼ˆChrome 92+, Firefox 89+ï¼‰

2. **æ–‡ä»¶å¤§å°é™åˆ¶**
   - è§†é¢‘ï¼š1GB
   - éŸ³é¢‘ï¼ˆæå–åï¼‰ï¼š~100MB
   - Supabase Storageï¼šå·²é…ç½® 100MB é™åˆ¶

3. **ä¸´æ—¶æ–‡ä»¶æ¸…ç†**
   - éŸ³é¢‘æ–‡ä»¶ä¼šåœ¨ 24 å°æ—¶åè‡ªåŠ¨åˆ é™¤
   - å¯åœ¨ Supabase Dashboard ä¸­è°ƒæ•´ç”Ÿå‘½å‘¨æœŸç­–ç•¥

### ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯
2. æŸ¥çœ‹ Supabase Edge Function æ—¥å¿—
3. ç¡®è®¤é˜¿é‡Œäº‘ API å‡­è¯æ˜¯å¦æ­£ç¡®
4. éªŒè¯ API è°ƒç”¨æ ¼å¼æ˜¯å¦ç¬¦åˆæ–‡æ¡£

### ğŸ¨ è®¾è®¡ç³»ç»Ÿ

åº”ç”¨ä½¿ç”¨å½±è§†å“‘å…‰é£æ ¼ï¼š
- **æ·±è‰²æ¨¡å¼**ï¼šå½±é™¢èˆ¬çš„æ·±ç°è“èƒŒæ™¯
- **æµ…è‰²æ¨¡å¼**ï¼šæš–è‰²è°ƒæç®€è®¾è®¡
- **å¼ºè°ƒè‰²**ï¼šé‡‘è‰²æ—¶é—´æˆ³ + é’è“è¿›åº¦æ¡
- **åŠ¨ç”»**ï¼šæµç•…çš„è¿‡æ¸¡å’Œå¾®åŠ¨æ•ˆ

---

**VideoNote** - è®©æ‚¨çš„è§†é¢‘æ”¶è—ä¸å†åƒç° âœ¨
